<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Cumulus MX</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">


        <link href="css/font-style.css" rel="stylesheet">
        <link href="css/main.css" rel="stylesheet">

        <!-- jquery -->
        <script src="lib/jquery/jquery-latest.min.js"></script>
        <script src="lib/jquery/jquery.tmpl.js"></script>

        <!-- Bootstrap -->
        <link href="lib/bootstrap/css/bootstrap.css" rel="stylesheet">
        <link href="lib/bootstrap/css/bootstrap-theme.css" rel="stylesheet" />
        <script src="lib/bootstrap/js/bootstrap.js"></script>

        <!-- DataTables CSS -->
        <link rel="stylesheet" type="text/css" href="lib/datatables/media/css/jquery.dataTables.css">

        <!-- DataTables -->
        <script src="lib/datatables/media/js/jquery.dataTables.js"></script>

        <!-- datepicker -->
        <script src="lib/datepicker/js/bootstrap-datepicker.js"></script>
        <link href="lib/datepicker/css/datepicker.css" rel="stylesheet">

        <link href="css/cumulus.css" rel="stylesheet">

        <script>
            $.fn.dataTable.ext.errMode = 'none';

            $(document).ready(function () {
                $.ajax({url: "api/settings/version.json", dataType:"json", success: function (result) {
                    $('#Version').text(result.Version);
                    $('#Build').text(result.Build);            
                }});
            
                var now = new Date();
                // subtract 1 day
                now.setTime(now.getTime()-(1*24*3600000));
                var mon = now.getMonth() + 1;
                mon = mon < 10 ? '0' + mon : mon;
                var dateStr = mon + '-' + now.getFullYear();

                $('#datepicker').datepicker({
                    format: "mm-yyyy",
                    viewMode: "months",
                    minViewMode: "months"
                }).val(dateStr);

                table = $('#datalog').dataTable({

                    "serverSide": true,
                    "searching": false,
                    "ordering": false,
                    "ajax": "api/data/logfile",
                    "deferLoading": 10
                });
            });

            function load() {
                value = $("#datepicker").val();

                table.api().ajax.url('api/data/logfile'+'?month='+value).load();
            }

        </script>


    </head>
    <body>

        <!-- NAVIGATION MENU -->
        <div class="navbar-nav navbar-inverse navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>   
                </div>
                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <li><a href="index.html">Dashboard</a></li>
                        <li><a href="now.html">Now</a></li>
                        <li><a href="gauges.html">Gauges</a></li>
                        <li><a href="charts.html">Charts</a></li>
                        <li><a href="todayyest.html">Today/Yesterday</a></li>
                        <li><a href="records.html">Records</a></li>
                        <li><a href="extra.html">Extra sensors</a></li>
                        <li class="dropdown active">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Data logs<span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <li><a href="datalogs.html">Data logs</a></li>
                                <li><a href="extradatalogs.html">Extra data logs</a></li>
                                <li><a href="dayfileviewer.html">Dayfile</a></li>                                
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Settings<span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <li><a href="stationsettings.html">Station settings</a></li>
                                <li><a href="internetsettings.html">Internet settings</a></li> 
                                <li><a href="extrawebfiles.html">Extra web files</a></li>
                                <li><a href="calibrationsettings.html">Calibration settings</a></li>
                                <li><a href="noaasettings.html">NOAA settings</a></li>
                                <li><a href="mysqlsettings.html">MySQL settings</a></li>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Edit<span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <li><a href="raintodayeditor.html">Today's rain</a></li>                              
                            </ul>
                        </li>
                    </ul>
                </div><!--/.nav-collapse -->
            </div>
        </div>
        <!-- END NAVIGATION MENU -->

        <div class="container">
            <div class="row top-buffer">
                <div class="col-md-12">
                    <h1>Data log viewer</h1>
                </div>
            </div>
            <div class="row">
                Select month:&nbsp;<input type="text" data-date-format="mm/yyyy" id="datepicker" >
                <button type="button" class="btn btn-default" onclick="load()">Load</button>

            </div>
            <div class="row top-buffer">
                <table id="datalog" class="display" cellspacing="0" width="100%">
                    <thead>
                        <tr>
                            <th>Date (dd/mm/yy)</th>
                            <th>Time</th>
                            <th>Temp</th>
                            <th>Hum</th>
                            <th>Dew point</th>
                            <th>Wind speed</th>
                            <th>Recent high gust</th>
                            <th>Average wind bearing</th>
                            <th>Rainfall rate</th>
                            <th>Rainfall so far</th>
                            <th>Sea level pressure</th>
                            <th>Rainfall counter</th>
                            <th>Inside temp</th>
                            <th>Inside hum</th>
                            <th>Current gust</th>
                            <th>Wind chill</th>
                            <th>Heat Index</th>
                            <th>UV Index</th>
                            <th>Solar Rad</th>
                            <th>ET</th>
                            <th>Annual ET</th>
                            <th>Apparent temp</th>
                            <th>Max Solar rad</th>
                            <th>Sun hours</th>
                            <th>Wind bearing</th>
                            <th>RG-11 Rain</th>
                            <th>Rain Since Midnight</th>
                        </tr>
                    </thead>

                    <!--<tfoot>
                        <tr>
                            <th>Date (dd/mm/yy)</th>
                            <th>Time</th>
                            <th>Temp</th>
                            <th>Hum</th>
                            <th>Dew point</th>
                            <th>Wind speed</th>
                            <th>Recent high gust</th>
                            <th>Average wind bearing</th>
                            <th>Rainfall rate</th>
                            <th>Rainfall so far</th>
                            <th>Sea level pressure</th>
                            <th>Rainfall counter</th>
                            <th>Inside temp</th>
                            <th>Inside hum</th>
                            <th>Current gust</th>
                            <th>Wind chill</th>
                            <th>Heat Index</th>
                            <th>UV Index</th>
                            <th>Solar Rad</th>
                            <th>ET</th>
                            <th>Annual ET</th>
                            <th>Apparent temp</th>
                            <th>Max Solar rad</th>
                            <th>Sun hours</th>
                            <th>Wind bearing</th>
                            <th>RG-11 Rain</th>
                            <th>Rain Since Midnight</th>
                        </tr>
                    </tfoot>-->
                </table>

            </div>
        </div>

        <div id="footerwrap">
            <footer class="clearfix"></footer>
            <div class="container">
                <div class="row">
                    <div class="col-sm-12 col-lg-12">
                        <!--<p><img src="img/logo.png" alt=""></p>-->
                        <p>Cumulus MX <span id="Version"></span>&nbsp;b<span id="Build"></span></p>
                    </div>
                </div><!-- /row -->
            </div><!-- /container -->		
        </div><!-- /footerwrap -->

    </body>


</html>